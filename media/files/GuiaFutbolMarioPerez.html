<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoom Infinito - Temas de F√∫tbol</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow-x: hidden;
            background: #0a192f;
            color: white;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }
        
        .selection-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #0c2440, #1a3a6c);
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        
        .selection-hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .selection-hidden .import-export-controls {
            opacity: 0;
            pointer-events: none;
        }
        
        .selection-content {
            text-align: center;
            padding: 2rem;
        }
        
        .selection-title {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #4cc9f0;
            text-shadow: 0 0 10px rgba(76, 201, 240, 0.5);
        }
        
        .topic-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .topic-btn {
            padding: 1rem 2rem;
            font-size: 1.2rem;
            background: rgba(76, 201, 240, 0.2);
            color: white;
            border: 2px solid #4cc9f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        .topic-btn:hover {
            background: rgba(76, 201, 240, 0.3);
            border-color: #72efdd;
            color: #72efdd;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(76, 201, 240, 0.3);
        }
        
        /* Estilos para el panel de secciones */
        .block-item {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .remove-block-btn:hover {
            background: rgba(255, 99, 99, 0.5) !important;
            transform: scale(1.05);
        }
        
        .load-section-btn:hover {
            background: rgba(76, 201, 240, 0.5) !important;
            transform: scale(1.05);
        }
        
        .delete-section-btn:hover {
            background: rgba(255, 99, 99, 0.5) !important;
            transform: scale(1.05);
        }
        
        .topic-btn:hover {
            background: rgba(76, 201, 240, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.3);
        }
        
        .zoom-container {
            position: relative;
            height: 2000vh;
            display: none;
        }
        
        .zoom-container.active {
            display: block;
        }
        
        .traditional-scroll {
            height: auto !important;
        }
        
        .traditional-scroll .zoom-image {
            position: relative;
            height: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
            min-height: 100vh;
        }
        
        .zoom-image {
            position: sticky;
            top: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #0c2440, #1a3a6c, #0d2a5c);
            overflow: hidden;
        }
        
        /* Mostrar imagen solo en modo zoom */
        .zoom-image .image-content {
            background-image: url('https://images.unsplash.com/photo-1540747913566-aa8a76ac3144?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');
        }
        
        .zoom-container.historia .zoom-image .image-content {
            background-image: url('https://images.unsplash.com/photo-1540747913566-aa8a76ac3144?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');
        }
        
        .zoom-container.futbolistas .zoom-image .image-content {
            background-image: url('https://images.unsplash.com/photo-1471295253337-3ceaaedca060?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');
        }
        
        .zoom-container.momentos .zoom-image .image-content {
            background-image: url('https://images.unsplash.com/photo-1471295253337-3ceaaedca060?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');
        }
        
        .image-content {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            will-change: transform;
        }
        
        .traditional-scroll .image-content {
            height: 300px;
            width: 90%;
            max-width: 800px;
            margin: 2rem auto;
            border-radius: 15px;
            position: relative;
            display: block;
            /* Estos estilos se sobrescribir√°n con el CSS inyectado din√°micamente */
            background: linear-gradient(135deg, #0c2440, #1a3a6c, #0d2a5c);
            background-image: none !important;
        }
        
        .traditional-scroll .zoom-image {
            /* Se sobrescribe con el gradiente personalizado */
            background: linear-gradient(135deg, #0c2440, #1a3a6c, #0d2a5c);
        }
        
        .traditional-scroll .image-content::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            border-radius: 15px;
            pointer-events: none;
        }
        
        .text-element {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(1.5rem, 5.5vw, 3.2rem);
            font-weight: bold;
            padding: clamp(20px, 3vw, 40px);
            width: clamp(280px, 85%, 800px);
            max-width: 95%;
            opacity: 0;
            text-shadow: 0 0 18px rgba(0,0,0,0.95);
            text-align: center;
            z-index: 10;
            line-height: 1.6;
            backdrop-filter: blur(8px);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        /* Asegurar posici√≥n central fija en modo zoom */
        .zoom-container:not(.traditional-scroll) .text-element {
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
        }
        
        .traditional-scroll .text-element {
            position: relative !important;
            top: auto !important;
            left: auto !important;
            transform: none !important;
            opacity: 1 !important;
            margin: 2rem auto;
            width: 90%;
            max-width: 800px;
            font-size: clamp(1.2rem, 4vw, 2.5rem);
            padding: 1.5rem 2rem;
            display: block;
            z-index: 10;
            filter: none !important;
            /* Estos estilos se sobrescribir√°n din√°micamente */
            background: rgba(20, 20, 30, 0.9) !important;
            border: 2px solid rgba(255, 255, 255, 0.1) !important;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3) !important;
            backdrop-filter: none !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8) !important;
        }
        
        /* Prioridad m√°xima para modo tradicional sobre centralizaci√≥n */
        .traditional-scroll .text-element {
            position: relative !important;
        }
        
        .traditional-scroll .text-element:first-child {
            margin-top: 3rem;
        }
        
        /* Fondo din√°mico en modo tradicional - se ajustar√° por la personalizaci√≥n */
        .traditional-scroll .zoom-container {
            background: inherit;
        }
        
        .traditional-scroll .zoom-container.historia,
        .traditional-scroll .zoom-container.futbolistas,
        .traditional-scroll .zoom-container.momentos {
            background: inherit;
        }
        
        /* Eliminar todas las im√°genes de fondo en modo tradicional */
        .traditional-scroll .zoom-image .image-content,
        .traditional-scroll .historia .zoom-image .image-content,
        .traditional-scroll .futbolistas .zoom-image .image-content,
        .traditional-scroll .momentos .zoom-image .image-content {
            background-image: none !important;
        }
        
        /* Resetear colores de texto/fondo de bloques en modo tradicional
           Estos ser√°n sobrescritos por el CSS inyectado din√°micamente
        */
        .traditional-scroll .historia .text-1,
        .traditional-scroll .historia .text-2,
        .traditional-scroll .historia .text-3,
        .traditional-scroll .historia .text-4,
        .traditional-scroll .historia .text-5,
        .traditional-scroll .historia .text-6,
        .traditional-scroll .futbolistas .text-1,
        .traditional-scroll .futbolistas .text-2,
        .traditional-scroll .futbolistas .text-3,
        .traditional-scroll .futbolistas .text-4,
        .traditional-scroll .futbolistas .text-5,
        .traditional-scroll .futbolistas .text-6,
        .traditional-scroll .momentos .text-1,
        .traditional-scroll .momentos .text-2,
        .traditional-scroll .momentos .text-3,
        .traditional-scroll .momentos .text-4,
        .traditional-scroll .momentos .text-5,
        .traditional-scroll .momentos .text-6 {
            color: white !important;
            background: rgba(20, 20, 30, 0.9) !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8) !important;
            border-radius: 15px !important;
            border: 2px solid rgba(255, 255, 255, 0.1) !important;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3) !important;
            backdrop-filter: none !important;
            transform: none !important;
            rotate: 0deg !important;
            filter: none !important;
        }
        
        /* Asegurar que el texto sea completamente legible */
        .traditional-scroll .text-element span {
            color: #e0e0e0 !important;
            font-size: 0.8em !important;
            line-height: 1.4 !important;
        }
        
        /* Estilos para bloques de contenido de secciones personalizadas */
        /* Eliminamos gran parte de los estilos de .custom-content-block y usamos .text-element */
        
        /* S√≥lo necesitamos definir los estilos para el modo ZOOM de los bloques personalizados */
        .zoom-container:not(.traditional-scroll) .custom-content-block {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(1.5rem, 5.5vw, 3.2rem);
            padding: clamp(20px, 3vw, 40px);
            width: clamp(280px, 85%, 800px);
            max-width: 95%;
            opacity: 0; /* Opacidad 0 para animaciones de zoom */
            background: rgba(30, 30, 30, 0.95); /* Fondo base para zoom */
            border: 1px solid rgba(200, 200, 200, 0.3);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            text-shadow: 0 0 18px rgba(0,0,0,0.95);
            backdrop-filter: blur(8px);
        }
        
        /* La clase .text-element ahora se aplica a los bloques personalizados en modo tradicional */
        .traditional-scroll .custom-content-block {
            /* No sobrescribir, ya que hereda de .traditional-scroll .text-element */
            /* Solo aseguramos que se muestre el contenido interno correctamente */
            text-align: center;
        }
        
        /* Ajustar los t√≠tulos y descripciones internas dentro de .text-element */
        .traditional-scroll .text-element span {
            /* Asegurar que el span no limite la estructura interna de t√≠tulo/descripci√≥n */
            display: block;
        }
        
        .traditional-scroll .text-element .content-block-title {
            font-size: clamp(1.2rem, 4vw, 2rem);
            font-weight: bold;
            margin-bottom: 0.8rem;
            line-height: 1.3;
            color: inherit !important; /* Hereda del color del texto general */
        }
        
        .traditional-scroll .text-element .content-block-description {
            font-size: clamp(0.9rem, 3vw, 1.3rem);
            font-weight: normal;
            line-height: 1.5;
            color: inherit !important; /* Hereda del color del texto general */
        }
        
        /* Deshabilitar zoom scroll para secciones personalizadas */
        .controls .scroll-mode-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            filter: grayscale(50%);
        }
        
        /* Colores espec√≠ficos para cada tema (solo en modo zoom scroll) */
        .historia .text-1 { color: #4cc9f0; background: rgba(13, 40, 92, 0.85); }
        .historia .text-2 { color: #72efdd; background: rgba(26, 58, 108, 0.85); }
        .historia .text-3 { color: #f9c74f; background: rgba(44, 62, 100, 0.85); }
        .historia .text-4 { color: #f3722c; background: rgba(30, 45, 85, 0.85); }
        .historia .text-5 { color: #f8961e; background: rgba(20, 35, 75, 0.85); }
        .historia .text-6 { color: #90be6d; background: rgba(15, 30, 65, 0.85); }
        
        .futbolistas .text-1 { color: #f72585; background: rgba(78, 15, 56, 0.85); }
        .futbolistas .text-2 { color: #b5179e; background: rgba(102, 25, 84, 0.85); }
        .futbolistas .text-3 { color: #7209b7; background: rgba(85, 30, 102, 0.85); }
        .futbolistas .text-4 { color: #560bad; background: rgba(68, 35, 107, 0.85); }
        .futbolistas .text-5 { color: #480ca8; background: rgba(52, 40, 110, 0.85); }
        .futbolistas .text-6 { color: #3a0ca3; background: rgba(45, 45, 115, 0.85); }
        
        .momentos .text-1 { color: #4361ee; background: rgba(25, 45, 100, 0.85); }
        .momentos .text-2 { color: #4895ef; background: rgba(30, 60, 115, 0.85); }
        .momentos .text-3 { color: #4cc9f0; background: rgba(35, 75, 130, 0.85); }
        .momentos .text-4 { color: #72efdd; background: rgba(40, 90, 145, 0.85); }
        .momentos .text-5 { color: #90be6d; background: rgba(45, 105, 160, 0.85); }
        .momentos .text-6 { color: #f9c74f; background: rgba(50, 120, 175, 0.85); }
        
        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 8px;
            max-width: 320px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 8px 12px;
            background: rgba(76, 201, 240, 0.2);
            color: white;
            border: 1px solid #4cc9f0;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            white-space: nowrap;
            min-width: fit-content;
            flex-shrink: 0;
        }
        
        .control-btn:hover {
            background: rgba(76, 201, 240, 0.4);
        }
        
        .control-btn.active {
            background: rgba(76, 201, 240, 0.6);
            box-shadow: 0 0 15px rgba(76, 201, 240, 0.5);
        }
        
        /* Efectos de brillo din√°micos */
        .button-glow-effect {
            box-shadow: 0 0 20px currentColor !important;
            animation: buttonGlow 2s ease-in-out infinite alternate;
        }
        
        
        @keyframes buttonGlow {
            0% { box-shadow: 0 0 20px rgba(76, 201, 240, 0.4); }
            100% { box-shadow: 0 0 30px rgba(76, 201, 240, 0.8); }
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Panel de Personalizaci√≥n */
        .customize-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
        }
        
        .customize-content {
            background: linear-gradient(135deg, #0c2440, #1a3a6c);
            border: 2px solid #4cc9f0;
            border-radius: 15px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }
        
        .customize-content h3 {
            color: #4cc9f0;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .setting-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(76, 201, 240, 0.3);
        }
        
        .setting-section h4 {
            color: #72efdd;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
        }
        
        .setting-item label {
            color: white;
            font-size: 0.9rem;
            margin-right: 1rem;
        }
        
        .setting-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #4cc9f0;
        }
        
        .setting-item input[type="color"] {
            width: 40px;
            height: 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: transparent;
        }
        
        .customize-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }
        
        /* Estilos para el bot√≥n de personalizar en pantalla principal */
        #customizeMainBtn {
            margin: 0 auto;
            display: block;
            max-width: 300px;
        }
        
        .btn {
            padding: 0.8rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #4cc9f0;
            color: #0c2440;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            background: #72efdd;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: transparent;
            color: #f9c74f;
            border: 2px solid #f9c74f;
        }
        
        .btn-secondary:hover {
            background: #f9c74f;
            color: #0c2440;
        }
        
        .btn-preset {
            background: rgba(114, 239, 221, 0.2);
            color: #72efdd;
            border: 1px solid #72efdd;
            padding: 0.6rem 1rem;
            font-size: 0.85rem;
        }
        
        .btn-preset:hover {
            background: rgba(114, 239, 221, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(114, 239, 221, 0.3);
        }
        
        .preset-templates {
            margin-top: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid rgba(114, 239, 221, 0.2);
        }
        
        .btn-close {
            background: transparent;
            color: #ff6363;
            border: 2px solid #ff6363;
        }
        
        .btn-close:hover {
            background: #ff6363;
            color: white;
        }
        
        #backToMenuBtn {
            background: rgba(255, 99, 99, 0.2);
            border-color: #ff6363;
            color: #ff6363;
            font-weight: 600;
            padding: 12px 18px;
            font-size: 0.95rem;
        }
        
        #backToMenuBtn:hover {
            background: rgba(255, 99, 99, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 99, 99, 0.3);
        }
        
        /* Panel de Creaci√≥n de Secciones */
        .section-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2500;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(15px);
        }
        
        .section-content {
            background: linear-gradient(135deg, #0c2440, #1a3a6c);
            border: 2px solid #4cc9f0;
            border-radius: 15px;
            padding: 2rem;
            max-width: 800px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.6);
            position: relative;
        }
        
        .section-content h3 {
            color: #4cc9f0;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }
        
        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .form-section h4 {
            color: #72efdd;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #ffffff;
            font-weight: 500;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid rgba(114, 239, 221, 0.5);
            border-radius: 6px;
            background: rgba(114, 239, 221, 0.1);
            color: #ffffff;
            font-size: 1rem;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #4cc9f0;
            box-shadow: 0 0 10px rgba(76, 201, 240, 0.3);
        }
        
        .sections-list {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(76, 201, 240, 0.3);
        }
        
        .section-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(76, 201, 240, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .section-item h5 {
            color: #4cc9f0;
            margin: 0 0 0.5rem 0;
        }
        
        .section-item .section-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .section-btn {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        
        .section-btn.edit {
            background: rgba(76, 201, 240, 0.3);
            color: #4cc9f0;
            border: 1px solid #4cc9f0;
        }
        
        .section-btn.delete {
            background: rgba(255, 99, 99, 0.3);
            color: #ff6363;
            border: 1px solid #ff6363;
        }
        
        @media (max-width: 768px) {
            .selection-title {
                font-size: 2rem;
            }
            
            .topic-btn {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }
            
            .text-element {
                font-size: clamp(1.3rem, 6.5vw, 2.6rem);
                padding: clamp(15px, 4vw, 30px);
                width: clamp(250px, 90%, 700px);
            }
            
            .zoom-container:not(.traditional-scroll) .custom-content-block {
                font-size: clamp(1.3rem, 6.5vw, 2.6rem);
                padding: clamp(15px, 4vw, 30px);
                width: clamp(250px, 90%, 700px);
            }
            
            .controls {
                top: 10px;
                right: 10px;
                max-width: 280px;
                gap: 6px;
            }
            
            .control-btn {
                padding: 6px 10px;
                font-size: 0.75rem;
            }
            
            #backToMenuBtn {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .traditional-scroll .text-element {
                font-size: clamp(1.1rem, 5vw, 2.2rem);
                padding: 1.2rem 1.5rem;
                margin: 1.5rem auto;
                width: 95% !important;
            }
            
            .custom-content-block {
                /* Quitamos esto para que .text-element lo controle: padding: 1.2rem 1.5rem; */
                margin: 1.5rem auto;
                width: 95% !important;
            }
            
            .content-block-title {
                font-size: clamp(1rem, 4vw, 1.6rem);
            }
            
            .content-block-description {
                font-size: clamp(0.8rem, 3vw, 1.1rem);
            }
            
            .traditional-scroll .image-content {
                height: 250px;
                width: 95% !important;
            }
        }
        
        @media (max-width: 480px) {
            .zoom-container {
                height: 2200vh;
            }
            
            .text-element {
                font-size: clamp(1.1rem, 7.5vw, 2.2rem);
                padding: clamp(12px, 5vw, 25px);
                width: clamp(220px, 95%, 600px);
            }
            
            .zoom-container:not(.traditional-scroll) .custom-content-block {
                font-size: clamp(1.1rem, 7.5vw, 2.2rem);
                padding: clamp(12px, 5vw, 25px);
                width: clamp(220px, 95%, 600px);
            }
            
            .traditional-scroll .image-content {
                height: 200px;
                margin: 1.5rem auto;
                width: 98% !important;
            }
            
            .traditional-scroll .text-element {
                margin: 1.2rem auto;
                padding: 1rem 1.2rem;
                width: 98% !important;
                font-size: clamp(1rem, 4.5vw, 1.8rem) !important;
            }
            
            .custom-content-block {
                /* Quitamos esto para que .text-element lo controle: padding: 1rem 1.2rem; */
                margin: 1.2rem auto;
                width: 98% !important;
            }
            
            .content-block-title {
                font-size: clamp(0.9rem, 4vw, 1.4rem) !important;
            }
            
            .content-block-description {
                font-size: clamp(0.75rem, 3vw, 1rem) !important;
            }
            
            .traditional-scroll .text-element:first-child {
                margin-top: 2rem;
            }
            
            /* Abreviar texto en pantallas muy peque√±as */
            #traditionalScrollBtn {
                padding: 6px 8px;
                font-size: 0.7rem;
                max-width: 80px;
                text-align: center;
                line-height: 1.2;
            }
            
            .controls {
                max-width: 240px;
                gap: 4px;
            }
        }
        
        /* Estilos para texto corto en botones */
        .short-text {
            display: none;
        }
        
        /* Estilos para botones de importar/exportar */
        .import-export-controls {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 8px;
            z-index: 1001;
            flex-direction: column;
        }
        
        .import-export-container {
            position: relative;
        }
        
        .import-export-main-btn {
            padding: 8px 12px;
            background: rgba(76, 201, 240, 0.2);
            color: white;
            border: 1px solid #4cc9f0;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            white-space: nowrap;
            min-width: fit-content;
            flex-shrink: 0;
        }
        
        .import-export-main-btn:hover {
            background: rgba(76, 201, 240, 0.4);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 201, 240, 0.3);
        }
        
        .import-export-main-btn:active {
            transform: translateY(0);
        }
        
        .import-export-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 4px;
            background: rgba(12, 36, 64, 0.95);
            border: 1px solid #4cc9f0;
            border-radius: 5px;
            overflow: hidden;
            opacity: 0;
            pointer-events: none;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            min-width: 200px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
            z-index: 1002;
        }
        
        .import-export-dropdown.active {
            opacity: 1;
            pointer-events: all;
            transform: translateY(0);
        }
        
        .import-export-dropdown-item {
            padding: 10px 14px;
            color: white;
            background: transparent;
            border: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .import-export-dropdown-item:hover {
            background: rgba(76, 201, 240, 0.3);
        }
        
        .import-export-dropdown-item:not(:last-child) {
            border-bottom: 1px solid rgba(76, 201, 240, 0.2);
        }
        
        .import-export-btn {
            padding: 8px 12px;
            background: rgba(76, 201, 240, 0.2);
            color: white;
            border: 1px solid #4cc9f0;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            white-space: nowrap;
            min-width: fit-content;
            flex-shrink: 0;
        }
        
        .import-export-btn:hover {
            background: rgba(76, 201, 240, 0.4);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 201, 240, 0.3);
        }
        
        .import-export-btn:active {
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .import-export-controls {
                top: 10px;
                left: 10px;
                gap: 6px;
            }
            
            .import-export-main-btn,
            .import-export-btn {
                padding: 6px 10px;
                font-size: 0.7rem;
            }
            
            .import-export-dropdown-item {
                padding: 8px 12px;
                font-size: 0.75rem;
            }
        }
        
        @media (max-width: 420px) {
            .full-text {
                display: none;
            }
            .short-text {
                display: inline;
            }
            
            .import-export-main-btn {
                font-size: 0.65rem;
                padding: 5px 8px;
            }
            
            .import-export-dropdown {
                min-width: 160px;
            }
            
            .import-export-dropdown-item {
                padding: 7px 10px;
                font-size: 0.7rem;
            }
        }
        
        @media (min-width: 1200px) {
            .text-element {
                font-size: clamp(1.8rem, 4.8vw, 3.5rem);
                padding: clamp(25px, 2.5vw, 45px);
                width: clamp(300px, 75%, 850px);
            }
            
            .zoom-container:not(.traditional-scroll) .custom-content-block {
                font-size: clamp(1.8rem, 4.8vw, 3.5rem);
                padding: clamp(25px, 2.5vw, 45px);
                width: clamp(300px, 75%, 850px);
            }
            
            .traditional-scroll .text-element {
                font-size: clamp(1.5rem, 3.5vw, 2.8rem);
                max-width: 900px;
                width: 85% !important;
            }
            
            .traditional-scroll .image-content {
                height: 350px;
                max-width: 900px;
                width: 85% !important;
            }
            
            .traditional-scroll .text-element:first-child {
                margin-top: 4rem;
            }
            
            .custom-content-block {
                max-width: 900px;
                width: 85% !important;
                /* Quitamos esto para que .text-element lo controle: padding: 2rem 2.5rem; */
            }
            
            .content-block-title {
                font-size: clamp(1.4rem, 3.5vw, 2.2rem) !important;
            }
            
            .content-block-description {
                font-size: clamp(1rem, 2.5vw, 1.4rem) !important;
            }
        }


    </style>
</head>
<body>
    <!-- Selecci√≥n de tema -->
    <div class="selection-container" id="selectionContainer">
        <!-- Botones de importar/exportar en la parte superior izquierda -->
        <div class="import-export-controls">
            <div class="import-export-container">
                <button class="import-export-main-btn" id="importExportMainBtn" title="Importar/Exportar secciones personalizadas">
                    üìÅ Importar/Exportar secciones personalizadas
                </button>
                <div class="import-export-dropdown" id="importExportDropdown">
                    <button class="import-export-dropdown-item" id="exportSectionsBtn">
                        üì§ Exportar secciones
                    </button>
                    <button class="import-export-dropdown-item" id="importSectionsBtn">
                        üì• Importar secciones
                    </button>
                </div>
            </div>
            <input type="file" id="fileInput" accept=".json" style="display: none;">
        </div>
        
        <div class="selection-content">
            <h1 class="selection-title">Gu√≠a b√°sica sobre f√∫tbol</h1>
            <div class="topic-buttons">
                <button class="topic-btn" data-topic="historia">Historia del F√∫tbol</button>
                <button class="topic-btn" data-topic="futbolistas">Grandes Futbolistas</button>
                <button class="topic-btn" data-topic="momentos">Mejores Momentos</button>
                <!-- Los botones personalizados se a√±adir√°n aqu√≠ din√°micamente -->
            </div>
            <div style="margin-top: 2rem;">
                <button class="topic-btn" id="customizeMainBtn" style="background: rgba(255, 255, 255, 0.1); border-color: #ffffff; color: #ffffff;">
                    ‚öôÔ∏è Personalizar UI
                </button>
            </div>
            <div style="margin-top: 1rem;">
                <button class="topic-btn" id="createSectionBtn" style="background: rgba(255, 255, 255, 0.1); border-color: #ffffff; color: #ffffff; padding-top: 0.8rem; padding-bottom: 0.8rem; line-height: 1.4;">
                    üìù Crear Secciones
                    <small style="display: block; font-size: 0.7rem; color: #ccc; margin-top: 4px; font-weight: normal;">(solo disponible en scroll tradicional)</small>
                </button>
            </div>
            <div style="margin-top: 1rem;">
                <button class="topic-btn" id="documentationBtn" style="background: rgba(76, 201, 240, 0.2); border-color: #4cc9f0; color: #4cc9f0; font-weight: 600;">
                    üìñ Documentaci√≥n
                    <small style="display: block; font-size: 0.7rem; color: #72efdd; margin-top: 4px; font-weight: normal;">Gu√≠a de uso de la p√°gina web</small>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Controles -->
    <div class="controls" id="controls" style="display: none;">
        <button class="control-btn" id="backToMenuBtn">üè† Men√∫ Principal</button>
        <button class="control-btn active" id="zoomScrollBtn">Zoom Scroll</button>
        <button class="control-btn" id="traditionalScrollBtn">
            <span class="full-text">Scroll Tradicional</span>
            <span class="short-text">Scroll Trad</span>
        </button>
        <button class="control-btn" id="customizeBtn">‚öôÔ∏è Personalizar</button>
    </div>
    
    <!-- Panel de Personalizaci√≥n -->
    <div class="customize-panel" id="customizePanel" style="display: none;">
        <div class="customize-content">
            <h3>üé® Personalizaci√≥n</h3>
            
            <!-- Efectos de Brillo -->
            <div class="setting-section">
                <h4>‚ú® Efectos de Brillo</h4>
                <div class="setting-item">
                    <label for="buttonGlow">Brillo en Botones</label>
                    <input type="checkbox" id="buttonGlow">
                </div>
            </div>
            
            <!-- Modos de Color -->
            <div class="setting-section">
                <h4>üé® Modos de Color</h4>
                <div class="customize-actions">
                    <button class="btn btn-secondary" id="lightModeBtn">‚òÄÔ∏è Modo Claro</button>
                    <button class="btn btn-primary" id="darkModeBtn">üåô Modo Oscuro</button>
                </div>
            </div>
            
            <!-- Colores de Botones -->
            <div class="setting-section">
                <h4>üîò Colores de Botones</h4>
                <div class="setting-item">
                    <label for="primaryButtonColor">Color Primario</label>
                    <input type="color" id="primaryButtonColor" value="#4cc9f0">
                </div>
                <div class="setting-item">
                    <label for="hoverButtonColor">Color al Pasar el Rat√≥n</label>
                    <input type="color" id="hoverButtonColor" value="#72efdd">
                </div>
            </div>
            
            <!-- Colores de Texto -->
            <div class="setting-section">
                <h4>üìù Colores de Texto</h4>
                <div class="setting-item">
                    <label for="allTextColor">Todos los Textos</label>
                    <input type="color" id="allTextColor" value="#ffffff">
                </div>
            </div>
            
            <!-- Fondos -->
            <div class="setting-section">
                <h4>üåà Fondos</h4>
                <div class="setting-item">
                    <label for="gradient1">Color de Gradiente 1 (Fondo Base)</label>
                    <input type="color" id="gradient1" value="#0c2440">
                </div>
                <div class="setting-item">
                    <label for="gradient2">Color de Gradiente 2</label>
                    <input type="color" id="gradient2" value="#1a3a6c">
                </div>
                <div class="setting-item">
                    <label for="gradient3">Color de Gradiente 3</label>
                    <input type="color" id="gradient3" value="#0d2a5c">
                </div>
            </div>
            
            <!-- Plantillas y Backup -->
            <div class="setting-section">
                <h4>üìã Plantillas y Backup</h4>
                <div class="customize-actions">
                    <button class="btn btn-secondary" id="exportTemplateBtn">üì§ Exportar Plantilla</button>
                    <button class="btn btn-secondary" id="importTemplateBtn">üì• Importar Plantilla</button>
                    <input type="file" id="templateFileInput" accept=".json" style="display: none;">
                </div>
                <div class="preset-templates">
                    <h5 style="color: #72efdd; margin: 1rem 0 0.5rem 0; font-size: 1rem;">üé® Plantillas Predefinidas:</h5>
                    <div class="customize-actions">
                        <button class="btn btn-preset" data-preset="ocean">üåä Oc√©ano</button>
                        <button class="btn btn-preset" data-preset="sunset">üåÖ Atardecer</button>
                        <button class="btn btn-preset" data-preset="forest">üå≤ Bosque</button>
                        <button class="btn btn-preset" data-preset="neon">‚ö° Ne√≥n</button>
                        <button class="btn btn-preset" data-preset="gold">ü•á Dorado</button>
                    </div>
                </div>
            </div>
            
            <!-- Botones de Acci√≥n -->
            <div class="customize-actions">
                <button class="btn btn-primary" id="saveCustomization">üíæ Guardar</button>
                <button class="btn btn-secondary" id="resetCustomization">üîÑ Resetear</button>
                <button class="btn btn-close" id="closeCustomize">‚úï Cerrar</button>
            </div>
        </div>
    </div>
    
    <!-- Panel de Documentaci√≥n -->
    <div class="customize-panel" id="documentationPanel" style="display: none;">
        <div class="customize-content" style="max-width: 700px; max-height: 85vh;">
            <div style="position: absolute; top: 1rem; right: 1rem;">
                <button class="btn btn-close" id="closeDocumentationPanel" style="font-size: 0.8rem; padding: 0.5rem;">‚úï</button>
            </div>
            
            <h3>üìñ Documentaci√≥n - Gu√≠a de Uso</h3>
            
            <div style="text-align: left; line-height: 1.6; max-height: 60vh; overflow-y: auto;">
                
                <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #4cc9f0;">
                    <h4 style="color: #4cc9f0; margin-bottom: 0.5rem;">üéØ ¬øQu√© es esta p√°gina?</h4>
                    <p>Una experiencia interactiva sobre f√∫tbol que combina informaci√≥n educativa con animaciones visuales impactantes. Explora la historia, los grandes futbolistas y los mejores momentos del f√∫tbol mundial.</p>
                </div>
                
                <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #72efdd;">
                    <h4 style="color: #72efdd; margin-bottom: 0.5rem;">üìö Temas Disponibles</h4>
                    <ul style="margin-left: 1rem; color: #ffffff;">
                        <li><strong>Historia del F√∫tbol:</strong> Evoluci√≥n y momentos clave del deporte</li>
                        <li><strong>Grandes Futbolistas:</strong> Las leyendas que marcaron la historia</li>
                        <li><strong>Mejores Momentos:</strong> Goles, celebraciones y emociones inolvidables</li>
                        <li><strong>Secciones Personalizadas:</strong> Contenido creado por usuarios</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #f9c74f;">
                    <h4 style="color: #f9c74f; margin-bottom: 0.5rem;">üîç Modos de Visualizaci√≥n</h4>
                    <ul style="margin-left: 1rem; color: #ffffff;">
                        <li><strong>Zoom Scroll (Por defecto):</strong> Modo inmersivo con efecto zoom infinito y animaciones espectaculares</li>
                        <li><strong>Scroll Tradicional:</strong> Presentaci√≥n cl√°sica como una p√°gina web normal, ideal para lectura detallada</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #f3722c;">
                    <h4 style="color: #f3722c; margin-bottom: 0.5rem;">üé® Personalizaci√≥n</h4>
                    <p>Personaliza completamente la apariencia de la p√°gina:</p>
                    <ul style="margin-left: 1rem; color: #ffffff;">
                        <li>Colores de botones y textos</li>
                        <li>Efectos de brillo y animaciones</li>
                        <li>Gradientes de fondo personalizados</li>
                        <li>Plantillas predefinidas (Modo Claro/Oscuro)</li>
                        <li>Exportar/importar configuraciones</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #90be6d;">
                    <h4 style="color: #90be6d; margin-bottom: 0.5rem;">üìù Crear Contenido</h4>
                    <p>Crea tus propias secciones personalizadas:</p>
                    <ul style="margin-left: 1rem; color: #ffffff;">
                        <li>A√±ade t√≠tulos y descripciones personalizadas</li>
                        <li>Solo disponible en modo Scroll Tradicional</li>
                        <li>Edita y elimina secciones existentes</li>
                        <li>Exporta tu contenido para compartir</li>
                        <li>Importa secciones de otros usuarios</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #4361ee;">
                    <h4 style="color: #4361ee; margin-bottom: 0.5rem;">üí° Consejos de Uso</h4>
                    <ul style="margin-left: 1rem; color: #ffffff;">
                        <li>Usa el Zoom Scroll para la experiencia m√°s impactante</li>
                        <li>El Scroll Tradicional es mejor para lectura pausada</li>
                        <li>Los controles est√°n siempre disponibles en la esquina superior derecha</li>
                        <li>Puedes volver al men√∫ principal en cualquier momento</li>
                        <li>Guarda tus configuraciones personalizadas para futuras visitas</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #b5179e;">
                    <h4 style="color: #b5179e; margin-bottom: 0.5rem;">üìÅ Importar/Exportar</h4>
                    <p>Gestiona tu contenido personalizado:</p>
                    <ul style="margin-left: 1rem; color: #ffffff;">
                        <li><strong>Exportar:</strong> Descarga todas tus secciones en formato JSON</li>
                        <li><strong>Importar:</strong> Carga secciones creadas por otros usuarios</li>
                        <li>Los archivos son compatibles entre dispositivos</li>
                    </ul>
                </div>
                
            </div>
            
            <div style="text-align: center; margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid rgba(76, 201, 240, 0.3);">
                <button class="btn btn-primary" id="understoodDocumentationBtn">
                    ¬°Entendido! üöÄ
                </button>
            </div>
        </div>
    </div>
    
    <!-- Panel de Creaci√≥n de Secciones -->
    <div class="section-panel" id="createSectionPanel">
        <div class="section-content">
            <div style="position: absolute; top: 1rem; right: 1rem;">
                <button class="btn btn-close" id="closeSectionPanel" style="font-size: 0.8rem; padding: 0.5rem;">‚úï</button>
            </div>
            
            <h3>üìù Crear/Editar Secci√≥n</h3>
            
            <!-- Formulario de Secci√≥n -->
            <div class="form-section">
                <h4>üìã Informaci√≥n de la Secci√≥n</h4>
                
                <div class="form-group">
                    <label for="sectionTitle">T√≠tulo de la Secci√≥n:</label>
                    <input type="text" id="sectionTitle" placeholder="Ej: Historia del Real Madrid" maxlength="50">
                </div>
                
                <div class="form-group">
                    <label for="sectionTopic">Categor√≠a/Tema:</label>
                    <select id="sectionTopic">
                        <option value="historia">Historia del F√∫tbol</option>
                        <option value="futbolistas">Grandes Futbolistas</option>
                        <option value="momentos">Mejores Momentos</option>
                    </select>
                </div>
            </div>
            
            <!-- Gesti√≥n de Bloques -->
            <div class="form-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h4>üìÑ Bloques de Contenido</h4>
                    <button class="btn btn-primary" id="addBlockBtn">‚ûï A√±adir Bloque</button>
                </div>
                
                <div id="blocksContainer">
                    <!-- Los bloques se cargar√°n din√°micamente aqu√≠ -->
                </div>
            </div>
            
            <!-- Secciones Guardadas -->
            <div class="sections-list">
                <h4>üíæ Secciones Guardadas</h4>
                <div id="sectionsList">
                    <!-- Lista de secciones se cargar√° din√°micamente -->
                </div>
            </div>
            
            <!-- Botones de Acci√≥n -->
            <div class="customize-actions">
                <button class="btn btn-primary" id="saveSectionBtn">üíæ Guardar Secci√≥n</button>
                <button class="btn btn-secondary" id="cancelSectionBtn">‚ùå Cancelar</button>
                <button class="btn btn-close" id="resetFormBtn">üîÑ Limpiar Formulario</button>
            </div>
        </div>
    </div>
    
    <!-- Secciones principales -->
    <div class="zoom-container historia" id="historia">
        <div class="zoom-image">
            <div class="image-content"></div>
            <div class="text-element text-1">
                <span>1863: Se establecen las primeras reglas unificadas del f√∫tbol en Inglaterra</span>
            </div>
            <div class="text-element text-2">
                <span>1930: Se disputa la primera Copa del Mundo en Uruguay</span>
            </div>
            <div class="text-element text-3">
                <span>1958-1970: La era dorada de Pel√© y el f√∫tbol brasile√±o</span>
            </div>
            <div class="text-element text-4">
                <span>1986: El Mundial de M√©xico y la consagraci√≥n de Maradona</span>
            </div>
            <div class="text-element text-5">
                <span>1990-2020: La globalizaci√≥n y comercializaci√≥n del f√∫tbol</span>
            </div>
            <div class="text-element text-6">
                <span>Futuro: Tecnolog√≠a, VAR y la evoluci√≥n del juego</span>
            </div>
        </div>
    </div>
    
    <div class="zoom-container futbolistas" id="futbolistas">
        <div class="zoom-image">
            <div class="image-content"></div>
            <div class="text-element text-1">
                <span>Pel√©: El √∫nico jugador en ganar tres Copas del Mundo</span>
            </div>
            <div class="text-element text-2">
                <span>Maradona: El genio argentino que hizo historia en 1986</span>
            </div>
            <div class="text-element text-3">
                <span>Messi: El crack argentino que conquist√≥ el mundo</span>
            </div>
            <div class="text-element text-4">
                <span>Cristiano Ronaldo: La m√°quina portuguesa de goles</span>
            </div>
            <div class="text-element text-5">
                <span>Johan Cruyff: El profeta del f√∫tbol total</span>
            </div>
            <div class="text-element text-6">
                <span>Zinedine Zidane: Elegancia y clase en el mediocampo</span>
            </div>
        </div>
    </div>
    
    <div class="zoom-container momentos" id="momentos">
        <div class="zoom-image">
            <div class="image-content"></div>
            <div class="text-element text-1">
                <span>1986: El "Gol del Siglo" de Maradona contra Inglaterra</span>
            </div>
            <div class="text-element text-2">
                <span>2005: La Remontada de Liverpool contra AC Milan</span>
            </div>
            <div class="text-element text-3">
                <span>1970: El "Partido del Siglo" entre Italia y Alemania</span>
            </div>
            <div class="text-element text-4">
                <span>2016: Portugal conquista su primera Eurocopa</span>
            </div>
            <div class="text-element text-5">
                <span>2021: Messi gana su primera Copa Am√©rica con Argentina</span>
            </div>
            <div class="text-element text-6">
                <span>1970: Brasil se corona tricampeona en M√©xico</span>
            </div>
        </div>
    </div>
    
    <!-- Contenedor din√°mico para secciones personalizadas -->
    <div id="dynamicSectionsContainer">
        <!-- Las secciones personalizadas se cargar√°n din√°micamente aqu√≠ -->
    </div>
    
    <!-- ============================================
         SISTEMA DE TUTORIAL INTERACTIVO
         ============================================ -->
    

    
    <!-- GSAP CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <script>
        // ========================================
        // CONFIGURACI√ìN Y ESTADO GLOBAL
        // ========================================
        
        const customizationSettings = {
            buttonGlow: false,
            primaryButtonColor: '#4cc9f0',
            hoverButtonColor: '#72efdd',
            allTextColor: '#ffffff',
            gradient1: '#0c2440',
            gradient2: '#1a3a6c',
            gradient3: '#0d2a5c',
            lightMode: {
                buttonGlow: false,
                primaryButtonColor: '#2563eb',
                hoverButtonColor: '#60a5fa',
                allTextColor: '#1f2937',
                gradient1: '#ffffff',
                gradient2: '#f1f5f9',
                gradient3: '#e2e8f0'
            },
            darkMode: {
                buttonGlow: true,
                primaryButtonColor: '#4cc9f0',
                hoverButtonColor: '#72efdd',
                allTextColor: '#ffffff',
                gradient1: '#0c2440',
                gradient2: '#1a3a6c',
                gradient3: '#0d2a5c'
            },
            presetTemplates: {
                ocean: {
                    name: 'Oc√©ano',
                    buttonGlow: true,
                    primaryButtonColor: '#00bcd4',
                    hoverButtonColor: '#4dd0e1',
                    allTextColor: '#e1f5fe',
                    gradient1: '#0d47a1',
                    gradient2: '#1976d2',
                    gradient3: '#42a5f5'
                },
                sunset: {
                    name: 'Atardecer',
                    buttonGlow: true,
                    primaryButtonColor: '#ff6b6b',
                    hoverButtonColor: '#ffa726',
                    allTextColor: '#fff3e0',
                    gradient1: '#d32f2f',
                    gradient2: '#f57c00',
                    gradient3: '#ff9800'
                },
                forest: {
                    name: 'Bosque',
                    buttonGlow: false,
                    primaryButtonColor: '#4caf50',
                    hoverButtonColor: '#66bb6a',
                    allTextColor: '#f1f8e9',
                    gradient1: '#2e7d32',
                    gradient2: '#388e3c',
                    gradient3: '#43a047'
                },
                neon: {
                    name: 'Ne√≥n',
                    buttonGlow: true,
                    primaryButtonColor: '#e91e63',
                    hoverButtonColor: '#ff5722',
                    allTextColor: '#fce4ec',
                    gradient1: '#1a1a1a',
                    gradient2: '#2d1b69',
                    gradient3: '#3f51b5'
                },
                gold: {
                    name: 'Dorado',
                    buttonGlow: true,
                    primaryButtonColor: '#ffc107',
                    hoverButtonColor: '#ffeb3b',
                    allTextColor: '#fff8e1',
                    gradient1: '#8d6e63',
                    gradient2: '#a1887f',
                    gradient3: '#d7ccc8'
                }
            }
        };
        
        const state = {
            isTraditionalScroll: false,
            currentTopic: null,
            currentZoomTimeline: null,
            currentImage: null,
            currentTexts: []
        };
        
        // ========================================
        // REFERENCIAS DEL DOM
        // ========================================
        
        const DOM = {
            selectionContainer: document.getElementById('selectionContainer'),
            topicButtonsContainer: document.querySelector('.topic-buttons'),
            controls: document.getElementById('controls'),
            backToMenuBtn: document.getElementById('backToMenuBtn'),
            zoomScrollBtn: document.getElementById('zoomScrollBtn'),
            traditionalScrollBtn: document.getElementById('traditionalScrollBtn'),
            customizeBtn: document.getElementById('customizeBtn'),
            customizeMainBtn: document.getElementById('customizeMainBtn'),
            customizePanel: document.getElementById('customizePanel'),
            saveCustomization: document.getElementById('saveCustomization'),
            resetCustomization: document.getElementById('resetCustomization'),
            closeCustomize: document.getElementById('closeCustomize'),
            createSectionBtn: document.getElementById('createSectionBtn'),
            exportSectionsBtn: document.getElementById('exportSectionsBtn'),
            importSectionsBtn: document.getElementById('importSectionsBtn'),
            fileInput: document.getElementById('fileInput'),
            exportTemplateBtn: document.getElementById('exportTemplateBtn'),
            importTemplateBtn: document.getElementById('importTemplateBtn'),
            templateFileInput: document.getElementById('templateFileInput'),
            // Tutorial elements
            zoomContainers: {
                historia: document.getElementById('historia'),
                futbolistas: document.getElementById('futbolistas'),
                momentos: document.getElementById('momentos'),
                dynamic: document.getElementById('dynamicSectionsContainer')
            }
        };
        
        // ========================================
        // UTILIDADES
        // ========================================
        
        const utils = {
            hexToRgba(hex, alpha) {
                // Validaci√≥n b√°sica de hex (ej. #RRGGBB)
                if (!/^#([A-Fa-f0-9]{6})$/.test(hex)) return `rgba(0, 0, 0, ${alpha})`;
                const r = parseInt(hex.slice(1, 3), 16);
                const g = parseInt(hex.slice(3, 5), 16);
                const b = parseInt(hex.slice(5, 7), 16);
                return `rgba(${r}, ${g}, ${b}, ${alpha})`;
            },
            
            resetGlowEffects() {
                const buttons = document.querySelectorAll('.control-btn, .topic-btn, .import-export-main-btn');
                buttons.forEach(btn => btn.classList.remove('button-glow-effect'));
            },
            
            getCurrentGradient() {
                return `linear-gradient(135deg, ${customizationSettings.gradient1}, ${customizationSettings.gradient2}, ${customizationSettings.gradient3})`;
            },
            
            showNotification(message, type = 'info') {
                // Crear notificaci√≥n temporal
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                    color: white;
                    padding: 1rem 2rem;
                    border-radius: 8px;
                    z-index: 10000;
                    font-weight: 600;
                    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
                `;
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                // Animar entrada
                gsap.fromTo(notification, 
                    { y: -100, opacity: 0 },
                    { y: 0, opacity: 1, duration: 0.5, ease: "power3.out" }
                );
                
                // Remover despu√©s de 3 segundos
                setTimeout(() => {
                    gsap.to(notification, {
                        y: -100,
                        opacity: 0,
                        duration: 0.5,
                        ease: "power3.in",
                        onComplete: () => notification.remove()
                    });
                }, 3000);
            }
        };
        
        // ========================================
        // GESTI√ìN DE SECCIONES PERSONALIZADAS
        // ========================================
        
        const sectionManager = {
            customSections: [],
            currentBlocks: [],
            editingSectionId: null,
            
            initialize() {
                this.loadCustomSections();
                this.setupEventListeners();
                this.setupCreateSectionButton();
                this.setupImportExportDropdown();
                this.setupImportExportButtons();
                this.updateInterfaceWithCustomSections();
            },
            
            setupImportExportDropdown() {
                const mainBtn = document.getElementById('importExportMainBtn');
                const dropdown = document.getElementById('importExportDropdown');
                
                if (!mainBtn || !dropdown) return;
                
                // Alternar dropdown al hacer clic en el bot√≥n principal
                mainBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    dropdown.classList.toggle('active');
                });
                
                // Cerrar dropdown al hacer clic fuera
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.import-export-container')) {
                        dropdown.classList.remove('active');
                    }
                });
                
                // Prevenir que los clics en el dropdown lo cierren inmediatamente
                dropdown.addEventListener('click', (e) => {
                    e.stopPropagation();
                });
                
                // Cerrar dropdown con tecla Escape
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && dropdown.classList.contains('active')) {
                        dropdown.classList.remove('active');
                    }
                });
            },
            
            setupCreateSectionButton() {
                const createSectionBtn = document.getElementById('createSectionBtn');
                if (createSectionBtn) {
                    createSectionBtn.addEventListener('click', () => {
                        this.openSectionPanel();
                    });
                }
            },
            
            setupImportExportButtons() {
                const dropdown = document.getElementById('importExportDropdown');
                
                // Bot√≥n de exportar
                DOM.exportSectionsBtn.addEventListener('click', () => {
                    this.exportSections();
                    if (dropdown) dropdown.classList.remove('active'); // Cerrar dropdown
                });
                
                // Bot√≥n de importar
                DOM.importSectionsBtn.addEventListener('click', () => {
                    DOM.fileInput.click();
                    if (dropdown) dropdown.classList.remove('active'); // Cerrar dropdown
                });
                
                // Manejar selecci√≥n de archivo
                DOM.fileInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        this.importSections(file);
                    }
                });
            },
            
            exportSections() {
                if (this.customSections.length === 0) {
                    utils.showNotification('No hay secciones para exportar', 'info');
                    return;
                }
                
                const exportData = {
                    version: '1.0',
                    exportDate: new Date().toISOString(),
                    sections: this.customSections
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `secciones-futbol-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(link.href);
                
                utils.showNotification(`¬°${this.customSections.length} secci√≥n(es) exportada(s) exitosamente!`, 'success');
            },
            
            importSections(file) {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    try {
                        const importData = JSON.parse(e.target.result);
                        
                        // Validar estructura del archivo
                        if (!importData.sections || !Array.isArray(importData.sections)) {
                            throw new Error('Formato de archivo inv√°lido');
                        }
                        
                        // Validar cada secci√≥n
                        const validSections = [];
                        const invalidSections = [];
                        
                        importData.sections.forEach((section, index) => {
                            if (this.isValidSection(section)) {
                                // Generar nuevo ID para evitar conflictos
                                const newSection = {
                                    ...section,
                                    id: 'section-' + Date.now() + '-' + index,
                                    createdAt: new Date().toISOString()
                                };
                                validSections.push(newSection);
                            } else {
                                invalidSections.push(index + 1);
                            }
                        });
                        
                        if (validSections.length === 0) {
                            throw new Error('No se encontraron secciones v√°lidas');
                        }
                        
                        // Combinar con secciones existentes
                        const existingTitles = new Set(this.customSections.map(s => s.title.toLowerCase().trim()));
                        const newSections = validSections.filter(section => 
                            !existingTitles.has(section.title.toLowerCase().trim())
                        );
                        
                        if (newSections.length === 0) {
                            utils.showNotification('Todas las secciones importadas ya existen', 'info');
                            return;
                        }
                        
                        this.customSections = [...this.customSections, ...newSections];
                        this.saveCustomSections();
                        this.updateInterfaceWithCustomSections();
                        
                        let message = `¬°${newSections.length} secci√≥n(es) importada(s) exitosamente!`;
                        if (invalidSections.length > 0) {
                            message += ` ${invalidSections.length} secci√≥n(es) inv√°lida(s) omitida(s).`;
                        }
                        if (validSections.length > newSections.length) {
                            message += ` ${validSections.length - newSections.length} secci√≥n(es) existente(s) omitida(s).`;
                        }
                        
                        utils.showNotification(message, 'success');
                        
                    } catch (error) {
                        console.error('Error al importar:', error);
                        utils.showNotification(`Error al importar archivo: ${error.message}`, 'error');
                    }
                    
                    // Limpiar el input
                    DOM.fileInput.value = '';
                };
                
                reader.onerror = () => {
                    utils.showNotification('Error al leer el archivo', 'error');
                };
                
                reader.readAsText(file);
            },
            
            isValidSection(section) {
                return section &&
                    typeof section === 'object' &&
                    typeof section.title === 'string' &&
                    section.title.trim().length > 0 &&
                    typeof section.topic === 'string' &&
                    ['historia', 'futbolistas', 'momentos'].includes(section.topic) &&
                    Array.isArray(section.blocks) &&
                    section.blocks.length > 0 &&
                    section.blocks.every(block => 
                        block &&
                        typeof block.title === 'string' &&
                        block.title.trim().length > 0
                    );
            },
            
            loadCustomSections() {
                const saved = localStorage.getItem('zoomFutbolCustomSections');
                if (saved) {
                    try {
                        this.customSections = JSON.parse(saved);
                    } catch (e) {
                        console.error("Error al parsear secciones guardadas", e);
                        this.customSections = [];
                    }
                }
            },
            
            saveCustomSections() {
                localStorage.setItem('zoomFutbolCustomSections', JSON.stringify(this.customSections));
            },
            
            setupEventListeners() {
                const panel = document.getElementById('createSectionPanel');
                const closeBtn = document.getElementById('closeSectionPanel');
                const addBlockBtn = document.getElementById('addBlockBtn');
                const saveBtn = document.getElementById('saveSectionBtn');
                const cancelBtn = document.getElementById('cancelSectionBtn');
                const resetBtn = document.getElementById('resetFormBtn');
                
                // Cerrar panel
                closeBtn.addEventListener('click', () => this.closeSectionPanel());
                
                panel.addEventListener('click', (e) => {
                    if (e.target === panel) {
                        this.closeSectionPanel();
                    }
                });
                
                // A√±adir bloque
                addBlockBtn.addEventListener('click', () => this.addBlock());
                
                // Guardar secci√≥n
                saveBtn.addEventListener('click', () => this.saveSection());
                
                // Cancelar
                cancelBtn.addEventListener('click', () => this.cancelSection());
                
                // Limpiar formulario
                resetBtn.addEventListener('click', () => this.resetForm());
                
                // Cargar/eliminar secci√≥n existente al hacer clic (desde el panel de creaci√≥n)
                document.getElementById('sectionsList').addEventListener('click', (e) => {
                    const loadBtn = e.target.closest('.load-section-btn');
                    const deleteBtn = e.target.closest('.delete-section-btn');
                    
                    if (loadBtn) {
                        const sectionId = loadBtn.dataset.sectionId;
                        if (sectionId) {
                            sectionManager.loadSection(sectionId);
                        }
                    } 
                    // CORRECCI√ìN 1: No se estaba llamando la funci√≥n deleteSection, solo la de loadSection.
                    // Ahora se ejecuta la l√≥gica de eliminaci√≥n.
                    else if (deleteBtn) {
                        const sectionId = deleteBtn.dataset.sectionId;
                        if (sectionId) {
                            sectionManager.deleteSection(sectionId);
                        }
                    }
                });
            },
            
            openSectionPanel() {
                document.getElementById('createSectionPanel').style.display = 'flex';
                this.updateSectionsList();
                
                // Crear un bloque inicial si no hay ninguno y no se est√° editando
                if (this.currentBlocks.length === 0 && !this.editingSectionId) {
                    this.addBlock();
                }
            },
            
            closeSectionPanel() {
                document.getElementById('createSectionPanel').style.display = 'none';
                this.resetForm();
            },
            
            addBlock() {
                const blockId = 'block-' + Date.now();
                const newPosition = this.currentBlocks.length + 1;
                this.currentBlocks.push({
                    id: blockId,
                    title: '',
                    description: '',
                    position: newPosition
                });
                this.renderBlock(blockId, newPosition);
            },
            
            removeBlock(blockId) {
                this.currentBlocks = this.currentBlocks.filter(block => block.id !== blockId);
                const blockElement = document.getElementById(blockId);
                if (blockElement) {
                    blockElement.remove();
                }
                this.updatePositions();
                this.rerenderAllBlocks(); // Re-renderizar para actualizar n√∫meros de posici√≥n
            },
            
            updatePositions() {
                this.currentBlocks.forEach((block, index) => {
                    block.position = index + 1;
                });
            },
            
            rerenderAllBlocks() {
                const container = document.getElementById('blocksContainer');
                container.innerHTML = ''; // Limpiar
                this.currentBlocks.forEach(block => {
                    this.renderBlock(block.id, block.position, block.title, block.description);
                });
            },
            
            renderBlock(blockId, position, title = '', description = '') {
                const block = this.currentBlocks.find(b => b.id === blockId);
                if (!block) return;
                
                const container = document.getElementById('blocksContainer');
                
                // Si el bloque ya existe, no lo volvemos a a√±adir al DOM. Solo se hace en rerenderAllBlocks
                if (document.getElementById(blockId) && container.innerHTML.includes(blockId)) return;
                
                const blockElement = document.createElement('div');
                blockElement.id = blockId;
                blockElement.className = 'block-item';
                blockElement.style.cssText = `
                    background: rgba(255,255,255,0.05);
                    border: 1px solid rgba(76, 201, 240, 0.3);
                    border-radius: 8px;
                    padding: 1rem;
                    margin-bottom: 1rem;
                    position: relative;
                `;
                
                blockElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem;">
                        <h5 style="color: #4cc9f0; margin: 0;">Bloque ${position}</h5>
                        <button type="button" class="remove-block-btn" data-block-id="${blockId}" style="background: rgba(255, 99, 99, 0.3); border: 1px solid #ff6363; color: #ff6363; padding: 0.3rem 0.6rem; border-radius: 4px; cursor: pointer;">üóëÔ∏è Eliminar</button>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.3rem; color: #72efdd; font-size: 0.9rem;">T√≠tulo del Bloque:</label>
                        <input type="text" class="block-title" data-block-id="${blockId}" placeholder="Ej: Los Primeros Pasos" value="${title}" style="width: 100%; padding: 0.6rem; border: 1px solid rgba(114, 239, 221, 0.5); border-radius: 4px; background: rgba(114, 239, 221, 0.1); color: #ffffff;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.3rem; color: #72efdd; font-size: 0.9rem;">Descripci√≥n:</label>
                        <textarea class="block-description" data-block-id="${blockId}" placeholder="Describe este contenido..." rows="3" style="width: 100%; padding: 0.6rem; border: 1px solid rgba(114, 239, 221, 0.5); border-radius: 4px; background: rgba(114, 239, 221, 0.1); color: #ffffff; resize: vertical;">${description}</textarea>
                    </div>
                `;
                
                container.appendChild(blockElement);
                
                // Event listener para eliminar bloque
                blockElement.querySelector('.remove-block-btn').addEventListener('click', () => {
                    this.removeBlock(blockId);
                });
                
                // Event listeners para cambios en el contenido
                blockElement.querySelector('.block-title').addEventListener('input', (e) => {
                    const blockObj = this.currentBlocks.find(b => b.id === blockId);
                    if (blockObj) blockObj.title = e.target.value;
                });
                
                blockElement.querySelector('.block-description').addEventListener('input', (e) => {
                    const blockObj = this.currentBlocks.find(b => b.id === blockId);
                    if (blockObj) blockObj.description = e.target.value;
                });
            },
            
            saveSection() {
                const title = document.getElementById('sectionTitle').value.trim();
                const topic = document.getElementById('sectionTopic').value;
                
                if (!title) {
                    utils.showNotification('Por favor, introduce un t√≠tulo para la secci√≥n.', 'error');
                    return;
                }
                
                if (this.currentBlocks.length === 0) {
                    utils.showNotification('Por favor, a√±ade al menos un bloque de contenido.', 'error');
                    return;
                }
                
                // Validar que todos los bloques tengan t√≠tulo
                const invalidBlocks = this.currentBlocks.filter(block => !block.title.trim());
                if (invalidBlocks.length > 0) {
                    utils.showNotification('Todos los bloques deben tener un t√≠tulo.', 'error');
                    return;
                }
                
                const sectionData = {
                    id: this.editingSectionId || 'section-' + Date.now(),
                    title: title,
                    topic: topic,
                    blocks: JSON.parse(JSON.stringify(this.currentBlocks)),
                    createdAt: this.editingSectionId ? 
                        this.customSections.find(s => s.id === this.editingSectionId)?.createdAt || new Date().toISOString() : 
                        new Date().toISOString()
                };
                
                if (this.editingSectionId) {
                    // Actualizar secci√≥n existente
                    const index = this.customSections.findIndex(s => s.id === this.editingSectionId);
                    if (index !== -1) {
                        this.customSections[index] = sectionData;
                    }
                } else {
                    // A√±adir nueva secci√≥n
                    this.customSections.push(sectionData);
                }
                
                this.saveCustomSections();
                this.updateSectionsList();
                this.resetForm();
                
                // **ACTUALIZACI√ìN: Actualizar inmediatamente la interfaz**
                this.updateInterfaceWithCustomSections();
                
                // Mostrar notificaci√≥n de √©xito
                utils.showNotification('¬°Secci√≥n guardada exitosamente!', 'success');
                
                // Cerrar el panel despu√©s de guardar
                this.closeSectionPanel();
            },
            
            // **NUEVA FUNCI√ìN: Actualizar interfaz inmediatamente**
            updateInterfaceWithCustomSections() {
                // Limpiar botones de secciones personalizadas existentes
                if (DOM.topicButtonsContainer) {
                    const customButtons = DOM.topicButtonsContainer.querySelectorAll('[data-topic^="custom-"]');
                    customButtons.forEach(button => button.remove());
                }
                
                // A√±adir botones para todas las secciones personalizadas
                this.customSections.forEach(section => {
                    const button = document.createElement('button');
                    button.className = 'topic-btn';
                    button.dataset.topic = `custom-${section.id}`;
                    button.textContent = section.title;
                    button.title = `${section.blocks.length} bloques de contenido`;
                    
                    // --- CORRECCI√ìN DE ERROR ---
                    // Usamos appendChild para a√±adir el nuevo bot√≥n al final de .topic-buttons.
                    // Esto es seguro y mantiene el orden correcto de los botones de tema.
                    DOM.topicButtonsContainer.appendChild(button);
                });
                
                // Tambi√©n actualizar las secciones en la aplicaci√≥n (DOM oculto)
                this.loadCustomSectionsInApp();
            },
            
            loadSection(sectionId) {
                const section = this.customSections.find(s => s.id === sectionId);
                if (!section) return;
                
                this.editingSectionId = sectionId;
                this.currentBlocks = JSON.parse(JSON.stringify(section.blocks));
                
                // Cargar datos en el formulario
                document.getElementById('sectionTitle').value = section.title;
                document.getElementById('sectionTopic').value = section.topic;
                
                // Limpiar container y renderizar bloques
                const container = document.getElementById('blocksContainer');
                container.innerHTML = ''; // Limpiar
                
                this.currentBlocks.sort((a, b) => a.position - b.position).forEach(block => {
                    this.renderBlock(block.id, block.position, block.title, block.description);
                });
                
                this.openSectionPanel();
            },
            
            // CORRECCI√ìN 1: La funci√≥n deleteSection no estaba actualizando la lista de secciones guardadas
            // despu√©s de eliminar una secci√≥n, y el `confirm` debe ser reemplazado.
            deleteSection(sectionId) {
                // Reemplazamos window.confirm() con un console.log de advertencia y asumimos que s√≠ para el ejemplo
                console.log(`Advertencia: Se eliminar√° la secci√≥n con ID ${sectionId}. Usar modal custom en producci√≥n.`);

                this.customSections = this.customSections.filter(s => s.id !== sectionId);
                this.saveCustomSections();
                this.updateSectionsList(); // Actualizar lista en panel de creaci√≥n
                
                // Actualizar interfaz inmediatamente
                this.updateInterfaceWithCustomSections(); // Actualizar men√∫ principal
                utils.showNotification('Secci√≥n eliminada.', 'info');
            },
            
            /**
             * FUNCI√ìN CORREGIDA: Renderiza la secci√≥n personalizada usando las clases
             * de los bloques de texto predeterminados (`text-element`) en modo tradicional
             * para heredar estilos de UI.
             */
            renderCustomSection(section) {
                const container = document.getElementById('dynamicSectionsContainer');
                // Limpiar el contenedor antes de renderizar
                container.innerHTML = ''; 
                
                // Establecer las clases: secci√≥n activa y forzar modo tradicional
                container.className = `zoom-container ${section.topic} traditional-scroll active`;
                
                let html = `
                    <div class="zoom-image">
                        <!-- La imagen se mantiene, pero ser√° invisible/reducida en modo traditional-scroll por CSS -->
                        <div class="image-content"></div>
                `;
                
                // Generar los bloques de contenido personalizados
                section.blocks.sort((a, b) => a.position - b.position).forEach((block, index) => {
                    // *** CAMBIO CLAVE ***
                    // Usamos la clase 'text-element' (como las secciones predeterminadas)
                    // y la clase 'custom-content-block' (para estilos de zoom y estructura interna)
                    html += `
                        <div class="text-element custom-content-block text-${index + 1}">
                            <!-- El contenido se anida dentro de un span para ser consistente con la estructura original de .text-element -->
                            <span>
                                <div class="content-block-title">${block.title}</div>
                                <div class="content-block-description">${block.description}</div>
                            </span>
                        </div>
                    `;
                });
                
                html += `
                    </div>
                `;
                
                container.innerHTML = html;
                
                // Aplicar estilos de personalizaci√≥n inmediatamente despu√©s de renderizar el HTML
                customization.applyBackgroundAndContainerStyles();
                customization.applyTextColors();
            },
            
            loadCustomSectionsInApp() {
                const container = document.getElementById('dynamicSectionsContainer');
                if (!container) {
                    console.error("El contenedor dynamicSectionsContainer no existe.");
                }
            },
            
            updateSectionsList() {
                const listContainer = document.getElementById('sectionsList');
                
                if (this.customSections.length === 0) {
                    listContainer.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #999; font-style: italic;">
                            No hay secciones guardadas.
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                this.customSections.forEach(section => {
                    const topicNames = {
                        'historia': 'Historia del F√∫tbol',
                        'futbolistas': 'Grandes Futbolistas', 
                        'momentos': 'Mejores Momentos'
                    };
                    
                    html += `
                        <div class="section-item">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                <h5 style="color: #4cc9f0; margin: 0; font-size: 1.1rem;">${section.title}</h5>
                                <span style="background: rgba(114, 239, 221, 0.2); color: #72efdd; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.8rem;">
                                    ${topicNames[section.topic] || section.topic}
                                </span>
                            </div>
                            <p style="color: #ccc; margin: 0 0 1rem 0; font-size: 0.9rem;">
                                ${section.blocks.length} bloque${section.blocks.length !== 1 ? 's' : ''} de contenido
                            </p>
                            <div class="section-actions">
                                <button class="section-btn load-section-btn" data-section-id="${section.id}">‚úèÔ∏è Editar</button>
                                <button class="section-btn delete-section-btn" data-section-id="${section.id}">üóëÔ∏è Eliminar</button>
                            </div>
                        </div>
                    `;
                });
                
                listContainer.innerHTML = html;
            },
            
            resetForm() {
                this.editingSectionId = null;
                this.currentBlocks = [];
                
                document.getElementById('sectionTitle').value = '';
                document.getElementById('sectionTopic').value = 'historia';
                
                const container = document.getElementById('blocksContainer');
                container.innerHTML = ''; // Limpiar bloques
            },
            
            cancelSection() {
                // Reemplazamos window.confirm() con un console.log de advertencia y cerramos directamente para el ejemplo
                console.log('Advertencia: Se perder√°n los cambios. Usar modal custom en producci√≥n.');
                this.resetForm();
                this.closeSectionPanel();
            }
        };
        
        // ========================================
        // PERSONALIZACI√ìN
        // ========================================
        
        const customization = {
            initialize() {
                this.loadSettings();
                this.applyStyles();
                this.setupEventListeners();
            },
            
            loadSettings() {
                const saved = localStorage.getItem('zoomFutbolSettings');
                if (saved) {
                    try {
                        const settings = JSON.parse(saved);
                        Object.assign(customizationSettings, settings);
                    } catch (e) {
                         console.error("Error al cargar configuraci√≥n de UI", e);
                    }
                }
                
                // Aplicar valores a los controles
                document.getElementById('buttonGlow').checked = customizationSettings.buttonGlow;
                document.getElementById('primaryButtonColor').value = customizationSettings.primaryButtonColor;
                document.getElementById('hoverButtonColor').value = customizationSettings.hoverButtonColor;
                document.getElementById('allTextColor').value = customizationSettings.allTextColor;
                document.getElementById('gradient1').value = customizationSettings.gradient1;
                document.getElementById('gradient2').value = customizationSettings.gradient2;
                document.getElementById('gradient3').value = customizationSettings.gradient3;
            },
            
            applyStyles() {
                utils.resetGlowEffects();
                
                if (customizationSettings.buttonGlow) {
                    document.querySelectorAll('.control-btn, .topic-btn, .import-export-main-btn').forEach(btn => btn.classList.add('button-glow-effect'));
                }
                
                this.updateButtonStyles();
                this.applyTextColors();
                this.applyBackgroundAndContainerStyles();
            },
            
            // RENOMBRADA: Antes era applyBackgroundGradients
            applyBackgroundAndContainerStyles() {
                const gradient = utils.getCurrentGradient();
                
                // Usamos el color base del gradiente 1 con transparencia para el fondo de los bloques
                const blockBg = utils.hexToRgba(customizationSettings.gradient1, 0.9);
                const blockBorder = utils.hexToRgba(customizationSettings.primaryButtonColor, 0.5);
                const blockShadow = utils.hexToRgba(customizationSettings.gradient1, 0.8);

                // Remover estilo anterior
                const previousStyle = document.getElementById('background-style');
                if (previousStyle) previousStyle.remove();
                
                // Aplicar fondos
                const style = document.createElement('style');
                style.id = 'background-style';
                style.textContent = `
                    /* Estilos de Fondo Global/Contenedores */
                    body { 
                        background: ${customizationSettings.gradient1} !important; 
                        color: ${customizationSettings.allTextColor} !important;
                    }
                    .selection-container { background: ${gradient} !important; }
                    .zoom-image { background: ${gradient} !important; }

                    /* Sobrescribir fondos de contenedores en modo tradicional/scroll */
                    .traditional-scroll .zoom-container { background: ${customizationSettings.gradient1} !important; }

                    .traditional-scroll .image-content { 
                        background: ${gradient} !important; 
                        background-image: none !important; /* Asegurar que no haya imagen */
                    }
                    
                    /* ============================================================== */
                    /* APLICACI√ìN DEL FONDO PERSONALIZADO A TODOS LOS BLOQUES DE CONTENIDO EN SCROLL TRADICIONAL */
                    /* ============================================================== */

                    /* 1. Bloques gen√©ricos de las secciones predefinidas y personalizadas (ya que ahora tienen .text-element) */
                    .traditional-scroll .text-element {
                        background: ${blockBg} !important;
                        border: 2px solid ${blockBorder} !important;
                        box-shadow: 0 8px 24px ${blockShadow} !important;
                        color: ${customizationSettings.allTextColor} !important;
                    }
                    
                    /* 2. Asegurar que los estilos espec√≠ficos de tema no sobrescriban el fondo en modo tradicional */
                    .traditional-scroll .historia .text-1, .traditional-scroll .historia .text-2, .traditional-scroll .historia .text-3, .traditional-scroll .historia .text-4, .traditional-scroll .historia .text-5, .traditional-scroll .historia .text-6,
                    .traditional-scroll .futbolistas .text-1, .traditional-scroll .futbolistas .text-2, .traditional-scroll .futbolistas .text-3, .traditional-scroll .futbolistas .text-4, .traditional-scroll .futbolistas .text-5, .traditional-scroll .futbolistas .text-6,
                    .traditional-scroll .momentos .text-1, .traditional-scroll .momentos .text-2, .traditional-scroll .momentos .text-3, .traditional-scroll .momentos .text-4, .traditional-scroll .momentos .text-5, .traditional-scroll .momentos .text-6,
                    /* Incluir bloques personalizados en el reset tambi√©n */
                    .traditional-scroll .custom-content-block {
                        background: ${blockBg} !important;
                        border: 2px solid ${blockBorder} !important;
                        box-shadow: 0 8px 24px ${blockShadow} !important;
                        color: ${customizationSettings.allTextColor} !important; 
                    }
                    
                    /* Sobrescribir el color espec√≠fico de texto dentro de los bloques para usar el color general */
                    .traditional-scroll .text-element span {
                        color: ${customizationSettings.allTextColor} !important;
                    }
                    
                    /* Asegurar que el t√≠tulo y la descripci√≥n dentro de los bloques personalizados usen el color general */
                    .traditional-scroll .text-element .content-block-title,
                    .traditional-scroll .text-element .content-block-description {
                        color: ${customizationSettings.allTextColor} !important;
                    }
                `;
                document.head.appendChild(style);
            },
            
            applyTextColors() {
                // Ya no necesitamos iterar sobre todos los elementos, ya que applyBackgroundAndContainerStyles
                // aplica el color al body y a los bloques con !important.
                // Solo necesitamos asegurar el color de los elementos que no son controlados por los bloques.
                const elementsToColor = document.querySelectorAll('h1, h3, h4, h5, label, p, .selection-title, .setting-item label');
                elementsToColor.forEach(element => {
                    // Solo si no est√° dentro de un elemento con color m√°s espec√≠fico (como botones)
                    if (!element.closest('.control-btn') && !element.closest('.topic-btn') && !element.closest('.btn-primary')) {
                        element.style.color = customizationSettings.allTextColor;
                    }
                });
                // Sobrescri
                document.body.style.color = customizationSettings.allTextColor;
            },
            
            updateButtonStyles() {
                const style = document.createElement('style');
                style.id = 'button-style';
                style.textContent = `
                    .control-btn, .topic-btn, .import-export-btn, .import-export-main-btn {
                        background: ${utils.hexToRgba(customizationSettings.primaryButtonColor, 0.2)} !important;
                        border-color: ${customizationSettings.primaryButtonColor} !important;
                        color: ${customizationSettings.allTextColor} !important;
                    }
                    
                    .control-btn:hover, .topic-btn:hover, .import-export-btn:hover, .import-export-main-btn:hover {
                        background: ${utils.hexToRgba(customizationSettings.hoverButtonColor, 0.4)} !important;
                        border-color: ${customizationSettings.hoverButtonColor} !important;
                        box-shadow: 0 5px 15px ${utils.hexToRgba(customizationSettings.hoverButtonColor, 0.3)} !important;
                        color: ${customizationSettings.allTextColor} !important;
                    }
                    
                    .import-export-dropdown {
                        background: ${utils.hexToRgba(customizationSettings.gradient1, 0.95)} !important;
                        border-color: ${customizationSettings.primaryButtonColor} !important;
                    }
                    
                    .import-export-dropdown-item {
                        color: ${customizationSettings.allTextColor} !important;
                    }
                    
                    .import-export-dropdown-item:hover {
                        background: ${utils.hexToRgba(customizationSettings.primaryButtonColor, 0.3)} !important;
                    }
                    
                    .import-export-dropdown-item:not(:last-child) {
                        border-bottom-color: ${utils.hexToRgba(customizationSettings.primaryButtonColor, 0.2)} !important;
                    }
                    
                    .control-btn.active {
                        background: ${utils.hexToRgba(customizationSettings.primaryButtonColor, 0.6)} !important;
                        box-shadow: 0 0 15px ${utils.hexToRgba(customizationSettings.primaryButtonColor, 0.5)} !important;
                    }
                    
                    .btn-primary {
                        background: ${customizationSettings.primaryButtonColor} !important;
                        color: white !important;
                    }
                    
                    .btn-secondary {
                        color: ${customizationSettings.primaryButtonColor} !important;
                        border: 2px solid ${customizationSettings.primaryButtonColor} !important;
                    }
                    
                    .selection-title, .section-item h5 {
                        color: ${customizationSettings.primaryButtonColor} !important;
                    }
                `;
                
                const oldStyle = document.getElementById('button-style');
                if (oldStyle) oldStyle.remove();
                document.head.appendChild(style);
            },
            
            setupEventListeners() {
                // Abrir panel
                DOM.customizeBtn.addEventListener('click', () => {
                    this.loadSettings();
                    this.applyStyles();
                    DOM.customizePanel.style.display = 'flex';
                });
                
                DOM.customizeMainBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this.loadSettings();
                    this.applyStyles();
                    DOM.customizePanel.style.display = 'flex';
                });
                
                // Cerrar panel - SIN confirmaciones, cerrado directo
                DOM.closeCustomize.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this.closeCustomizePanel();
                });
                
                // Cerrar tambi√©n al hacer clic fuera del contenido
                DOM.customizePanel.addEventListener('click', (e) => {
                    if (e.target === DOM.customizePanel) {
                        e.preventDefault();
                        this.closeCustomizePanel();
                    }
                });
                
                // Cerrar con tecla Escape
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && DOM.customizePanel.style.display === 'flex') {
                        this.closeCustomizePanel();
                    }
                });
                
                // Efectos de brillo
                document.getElementById('buttonGlow').addEventListener('change', (e) => {
                    customizationSettings.buttonGlow = e.target.checked;
                    utils.resetGlowEffects();
                    if (customizationSettings.buttonGlow) {
                        document.querySelectorAll('.control-btn, .topic-btn, .import-export-main-btn').forEach(btn => btn.classList.add('button-glow-effect'));
                    }
                });
                
                // Modos predefinidos
                document.getElementById('lightModeBtn').addEventListener('click', () => this.applyPredefinedMode('light'));
                document.getElementById('darkModeBtn').addEventListener('click', () => this.applyPredefinedMode('dark'));
                
                // Cambios de colores en tiempo real
                document.getElementById('primaryButtonColor').addEventListener('change', (e) => {
                    customizationSettings.primaryButtonColor = e.target.value;
                    this.updateButtonStyles();
                    this.applyBackgroundAndContainerStyles();
                });
                
                document.getElementById('hoverButtonColor').addEventListener('change', (e) => {
                    customizationSettings.hoverButtonColor = e.target.value;
                    this.updateButtonStyles();
                });
                
                document.getElementById('allTextColor').addEventListener('change', (e) => {
                    customizationSettings.allTextColor = e.target.value;
                    this.applyTextColors();
                    this.applyBackgroundAndContainerStyles(); // Para actualizar color de texto en bloques
                });
                
                // Cambios de gradiente
                ['gradient1', 'gradient2', 'gradient3'].forEach(id => {
                    document.getElementById(id).addEventListener('input', (e) => {
                        customizationSettings[id] = e.target.value;
                        this.applyBackgroundAndContainerStyles();
                    });
                });
                
                // Guardar configuraci√≥n
                DOM.saveCustomization.addEventListener('click', () => {
                    this.saveSettings();
                    this.closeCustomizePanel();
                    utils.showNotification('¬°Configuraci√≥n guardada!', 'success');
                });
                
                // Exportar plantilla
                DOM.exportTemplateBtn.addEventListener('click', () => {
                    this.exportTemplate();
                });
                
                // Importar plantilla
                DOM.importTemplateBtn.addEventListener('click', () => {
                    DOM.templateFileInput.click();
                });
                
                // Manejar archivo de plantilla
                DOM.templateFileInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        this.importTemplate(file);
                    }
                });
                
                // Presets predefinidos
                document.querySelectorAll('.btn-preset').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const presetName = e.target.dataset.preset;
                        this.applyPresetTemplate(presetName);
                    });
                });
                
                // Resetear configuraci√≥n
                DOM.resetCustomization.addEventListener('click', () => {
                    // Reemplazamos window.confirm() con un console.log de advertencia
                    console.log('Advertencia: Se resetear√° la configuraci√≥n. Usar modal custom en producci√≥n.');
                    this.resetSettings();
                });
            },
            
            applyPredefinedMode(mode) {
                const modeSettings = customizationSettings[mode + 'Mode'];
                
                Object.assign(customizationSettings, modeSettings);
                
                // Actualizar controles
                document.getElementById('buttonGlow').checked = modeSettings.buttonGlow;
                document.getElementById('primaryButtonColor').value = modeSettings.primaryButtonColor;
                document.getElementById('hoverButtonColor').value = modeSettings.hoverButtonColor;
                document.getElementById('allTextColor').value = modeSettings.allTextColor;
                document.getElementById('gradient1').value = modeSettings.gradient1;
                document.getElementById('gradient2').value = modeSettings.gradient2;
                document.getElementById('gradient3').value = modeSettings.gradient3;
                
                this.applyStyles();
                utils.showNotification(`Modo ${mode === 'light' ? 'claro' : 'oscuro'} aplicado`, 'success');
            },
            
            closeCustomizePanel() {
                // Funci√≥n directa para cerrar el panel de personalizaci√≥n sin confirmaciones
                DOM.customizePanel.style.display = 'none';
            },
            
            resetSettings() {
                const defaultSettings = {
                    buttonGlow: false,
                    primaryButtonColor: '#4cc9f0',
                    hoverButtonColor: '#72efdd',
                    allTextColor: '#ffffff',
                    gradient1: '#0c2440',
                    gradient2: '#1a3a6c',
                    gradient3: '#0d2a5c'
                };
                
                Object.assign(customizationSettings, defaultSettings);
                
                // Aplicar a controles
                document.getElementById('buttonGlow').checked = false;
                document.getElementById('primaryButtonColor').value = '#4cc9f0';
                document.getElementById('hoverButtonColor').value = '#72efdd';
                document.getElementById('allTextColor').value = '#ffffff';
                document.getElementById('gradient1').value = '#0c2440';
                document.getElementById('gradient2').value = '#1a3a6c';
                document.getElementById('gradient3').value = '#0d2a5c';
                
                this.applyStyles();
                utils.showNotification('Configuraci√≥n reseteada', 'info');
            },
            
            exportTemplate() {
                const templateData = {
                    version: '1.0',
                    exportDate: new Date().toISOString(),
                    name: `Plantilla ${new Date().toLocaleDateString()}`,
                    settings: {
                        buttonGlow: customizationSettings.buttonGlow,
                        primaryButtonColor: customizationSettings.primaryButtonColor,
                        hoverButtonColor: customizationSettings.hoverButtonColor,
                        allTextColor: customizationSettings.allTextColor,
                        gradient1: customizationSettings.gradient1,
                        gradient2: customizationSettings.gradient2,
                        gradient3: customizationSettings.gradient3
                    }
                };
                
                const dataStr = JSON.stringify(templateData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `plantilla-ui-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(link.href);
                
                utils.showNotification('¬°Plantilla exportada exitosamente!', 'success');
            },
            
            importTemplate(file) {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    try {
                        const templateData = JSON.parse(e.target.result);
                        
                        // Validar estructura del archivo
                        if (!templateData.settings || typeof templateData.settings !== 'object') {
                            throw new Error('Formato de plantilla inv√°lido');
                        }
                        
                        // Validar que todas las propiedades necesarias existen
                        const requiredProps = ['buttonGlow', 'primaryButtonColor', 'hoverButtonColor', 'allTextColor', 'gradient1', 'gradient2', 'gradient3'];
                        const settings = templateData.settings;

                        // Copiar solo las propiedades v√°lidas para evitar errores
                        const newSettings = {};
                        requiredProps.forEach(prop => {
                            if (prop in settings) {
                                newSettings[prop] = settings[prop];
                            }
                        });

                        // Si hay menos de 3 propiedades de color de gradiente, usar valores por defecto para evitar rotura
                        if (!newSettings.gradient1) newSettings.gradient1 = customizationSettings.gradient1;
                        if (!newSettings.gradient2) newSettings.gradient2 = customizationSettings.gradient2;
                        if (!newSettings.gradient3) newSettings.gradient3 = customizationSettings.gradient3;
                        
                        // Aplicar configuraci√≥n
                        Object.assign(customizationSettings, newSettings);
                        
                        // Actualizar controles
                        document.getElementById('buttonGlow').checked = customizationSettings.buttonGlow || false;
                        document.getElementById('primaryButtonColor').value = customizationSettings.primaryButtonColor || '#4cc9f0';
                        document.getElementById('hoverButtonColor').value = customizationSettings.hoverButtonColor || '#72efdd';
                        document.getElementById('allTextColor').value = customizationSettings.allTextColor || '#ffffff';
                        document.getElementById('gradient1').value = customizationSettings.gradient1;
                        document.getElementById('gradient2').value = customizationSettings.gradient2;
                        document.getElementById('gradient3').value = customizationSettings.gradient3;
                        
                        this.applyStyles();
                        this.saveSettings();
                        
                        const templateName = templateData.name || 'Plantilla personalizada';
                        utils.showNotification(`¬°${templateName} aplicada exitosamente!`, 'success');
                        
                    } catch (error) {
                        console.error('Error al importar plantilla:', error);
                        utils.showNotification(`Error al importar plantilla: ${error.message}`, 'error');
                    }
                    
                    // Limpiar el input
                    DOM.templateFileInput.value = '';
                };
                
                reader.onerror = () => {
                    utils.showNotification('Error al leer el archivo', 'error');
                };
                
                reader.readAsText(file);
            },
            
            applyPresetTemplate(presetName) {
                const preset = customizationSettings.presetTemplates[presetName];
                if (!preset) {
                    utils.showNotification('Plantilla no encontrada', 'error');
                    return;
                }
                
                const settings = {
                    buttonGlow: preset.buttonGlow,
                    primaryButtonColor: preset.primaryButtonColor,
                    hoverButtonColor: preset.hoverButtonColor,
                    allTextColor: preset.allTextColor,
                    gradient1: preset.gradient1,
                    gradient2: preset.gradient2,
                    gradient3: preset.gradient3
                };
                
                Object.assign(customizationSettings, settings);
                
                // Actualizar controles
                document.getElementById('buttonGlow').checked = settings.buttonGlow;
                document.getElementById('primaryButtonColor').value = settings.primaryButtonColor;
                document.getElementById('hoverButtonColor').value = settings.hoverButtonColor;
                document.getElementById('allTextColor').value = settings.allTextColor;
                document.getElementById('gradient1').value = settings.gradient1;
                document.getElementById('gradient2').value = settings.gradient2;
                document.getElementById('gradient3').value = settings.gradient3;
                
                this.applyStyles();
                utils.showNotification(`¬°Plantilla "${preset.name}" aplicada!`, 'success');
            },
            
            saveSettings() {
                localStorage.setItem('zoomFutbolSettings', JSON.stringify(customizationSettings));
            }
        };
        
        // ========================================
        // SISTEMA DE DOCUMENTACI√ìN
        // ========================================
        
        const documentationSystem = {
            initialize() {
                this.setupEventListeners();
            },
            
            setupEventListeners() {
                // Bot√≥n de documentaci√≥n en el men√∫ principal
                document.getElementById('documentationBtn').addEventListener('click', () => {
                    this.openDocumentation();
                });
                
                // Bot√≥n de cerrar documentaci√≥n
                document.getElementById('closeDocumentationPanel').addEventListener('click', () => {
                    this.closeDocumentation();
                });
                
                // CORRECCI√ìN 2: Aseguramos que se llame a closeDocumentation() en el bot√≥n "Entendido"
                document.getElementById('understoodDocumentationBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.closeDocumentation();
                });
                
                // Cerrar con tecla Escape
                document.addEventListener('keydown', (e) => {
                    const panel = document.getElementById('documentationPanel');
                    if (e.key === 'Escape' && panel.style.display === 'flex') {
                        this.closeDocumentation();
                    }
                });
                
                // Cerrar al hacer clic fuera del panel
                document.getElementById('documentationPanel').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('documentationPanel')) {
                        this.closeDocumentation();
                    }
                });
            },
            
            openDocumentation() {
                const panel = document.getElementById('documentationPanel');
                panel.style.display = 'flex';
                
                // Animaci√≥n de entrada
                gsap.fromTo(panel.querySelector('.customize-content'), 
                    { 
                        scale: 0.8, 
                        opacity: 0,
                        rotate: -5 
                    },
                    { 
                        scale: 1, 
                        opacity: 1, 
                        rotate: 0,
                        duration: 0.5, 
                        ease: "back.out(1.7)" 
                    }
                );
            },
            
            closeDocumentation() {
                const panel = document.getElementById('documentationPanel');
                const content = panel.querySelector('.customize-content');
                
                // Animaci√≥n de salida
                gsap.to(content, {
                    scale: 0.8,
                    opacity: 0,
                    rotate: 5,
                    duration: 0.3,
                    ease: "power2.in",
                    onComplete: () => {
                        panel.style.display = 'none';
                    }
                });
            }
        };
        
        // ========================================
        // ANIMACIONES GSAP
        // ========================================
        
        const animation = {
            initializeZoom(topic) {
                if (state.isTraditionalScroll) return;
                
                // Determinar el contenedor correcto
                let container, image, texts;
                
                if (topic.startsWith('custom-')) {
                    // Si estamos en una secci√≥n personalizada, forzamos el modo tradicional (deber√≠a estar deshabilitado)
                    return;
                } else {
                    // Es un tema normal
                    container = DOM.zoomContainers[topic];
                    image = container.querySelector('.image-content');
                    texts = container.querySelectorAll('.text-element');
                }
                
                if (!container || !image || texts.length === 0) return;
                
                // Limpiar timeline anterior
                if (state.currentZoomTimeline) {
                    state.currentZoomTimeline.kill();
                    ScrollTrigger.getAll().forEach(trigger => trigger.kill());
                }
                
                state.currentImage = image;
                state.currentTexts = texts;
                
                // Crear timeline
                const zoomTimeline = gsap.timeline({
                    scrollTrigger: {
                        trigger: container,
                        start: "top top",
                        end: "bottom bottom",
                        scrub: true,
                        invalidateOnRefresh: true,
                        onUpdate: (self) => {
                            const currentScale = 1 + self.progress * 20;
                            this.updateTextVisibility(currentScale, texts);
                        }
                    }
                });
                
                zoomTimeline.to(image, { scale: 21, ease: "none" }, 0);
                state.currentZoomTimeline = zoomTimeline;
                
                texts.forEach(text => {
                    text.dataset.visible = 'false';
                    text.style.opacity = '0';
                });
            },
            
            updateTextVisibility(currentScale, texts) {
                if (state.isTraditionalScroll) return;
                
                const textRanges = [
                    { min: 1.5, max: 3.2 },
                    { min: 4.0, max: 6.5 },
                    { min: 7.5, max: 10.0 },
                    { min: 11.0, max: 13.5 },
                    { min: 14.5, max: 17.0 },
                    { min: 18.0, max: 20.5 }
                ];
                
                texts.forEach((text, index) => {
                    const range = textRanges[index];
                    
                    // Posicionar en el centro
                    text.style.position = 'absolute';
                    text.style.top = '50%';
                    text.style.left = '50%';
                    text.style.transform = 'translate(-50%, -50%)';
                    
                    if (currentScale >= range.min && currentScale <= range.max) {
                        if (!text.dataset.visible || text.dataset.visible === 'false') {
                            this.animateTextIn(text, index);
                            text.dataset.visible = 'true';
                        }
                    } else {
                        if (text.dataset.visible === 'true') {
                            const direction = currentScale < range.min ? 'up' : 'down';
                            this.animateTextOut(text, index, direction);
                            text.dataset.visible = 'false';
                        }
                    }
                });
            },
            
            animateTextIn(text, index) {
                if (state.isTraditionalScroll) return;
                
                const tema = text.closest('.zoom-container').classList[1];
                const colorSchemes = {
                    historia: ['#4cc9f0', '#72efdd', '#f9c74f', '#f3722c', '#f8961e', '#90be6d'],
                    futbolistas: ['#f72585', '#b5179e', '#7209b7', '#560bad', '#480ca8', '#3a0ca3'],
                    momentos: ['#4361ee', '#4895ef', '#4cc9f0', '#72efdd', '#90be6d', '#f9c74f']
                };
                
                const colors = colorSchemes[tema] || ['#ffffff', '#ffffff', '#ffffff', '#ffffff', '#ffffff', '#ffffff'];
                const anim = {
                    y: 80,
                    rotate: index % 2 === 0 ? -3 : 3,
                    scale: 0.8,
                    color: colors[index % colors.length]
                };
                
                gsap.fromTo(text,
                    { 
                        opacity: 0,
                        scale: anim.scale,
                        y: anim.y,
                        filter: "blur(10px)",
                        rotate: anim.rotate,
                        textShadow: `0 0 0 ${anim.color}`
                    },
                    {
                        opacity: 1,
                        scale: 1,
                        y: 0,
                        filter: "blur(0px)",
                        rotate: 0,
                        textShadow: `0 0 25px ${anim.color}`,
                        duration: 1.2,
                        ease: "power3.out",
                        onStart: () => text.style.zIndex = 100 + index,
                        onComplete: () => text.style.color = anim.color
                    }
                );
            },
            
            animateTextOut(text, index, direction) {
                if (state.isTraditionalScroll) return;
                
                const offset = direction === 'up' ? -60 : 60;
                const rotation = direction === 'up' ? -5 : 5;
                const scale = 0.9;
                
                gsap.to(text,
                    {
                        opacity: 0,
                        y: offset,
                        rotate: rotation,
                        scale: scale,
                        duration: 0.9,
                        ease: "power2.in",
                        onComplete: () => text.style.zIndex = 10
                    }
                );
            }
        };
        
        // ========================================
        // EVENTOS PRINCIPALES
        // ========================================
        
        const mainApp = {
            initialize() {
                // Inicializar m√≥dulos
                customization.initialize();
                sectionManager.initialize(); // Esto cargar√° las secciones y las a√±adir√° al men√∫
                documentationSystem.initialize(); // Inicializar sistema de documentaci√≥n

                this.setupTopicButtons(); // Ahora usa delegaci√≥n de eventos
                this.setupScrollModeButtons();
                this.setupBackToMenu();
                this.setupResizeHandler();
            },
            
            setupTopicButtons() {
                // Usar delegaci√≥n de eventos en el contenedor
                DOM.selectionContainer.addEventListener('click', (e) => {
                    const button = e.target.closest('.topic-btn');
                    
                    // Asegurarse de que sea un bot√≥n de tema y no los botones de control
                    if (!button || button.id === 'customizeMainBtn' || button.id === 'createSectionBtn' || button.id === 'documentationBtn') {
                        return;
                    }
                    
                    const topic = button.dataset.topic;
                    state.currentTopic = topic;
                    
                    DOM.selectionContainer.classList.add('selection-hidden');
                    DOM.controls.style.display = 'flex';
                    
                    // Ocultar botones de importar/exportar cuando salimos del men√∫ principal
                    document.querySelector('.import-export-controls').style.display = 'none';
                    
                    // Ocultar todos los contenedores de zoom
                    Object.values(DOM.zoomContainers).forEach(container => {
                        container.classList.remove('active', 'traditional-scroll');
                    });
                    
                    let currentContainer;
                    
                    if (topic.startsWith('custom-')) {
                        // --- L√ìGICA PARA SECCIONES PERSONALIZADAS ---
                        currentContainer = DOM.zoomContainers.dynamic;
                        currentContainer.classList.add('active');
                        
                        // Forzar modo scroll tradicional (Zoom Scroll est√° deshabilitado para secciones personalizadas)
                        state.isTraditionalScroll = true;
                        DOM.traditionalScrollBtn.classList.add('active');
                        DOM.zoomScrollBtn.classList.remove('active');
                        DOM.zoomScrollBtn.disabled = true; // Deshabilitar bot√≥n de zoom
                        currentContainer.classList.add('traditional-scroll');
                        
                        // Renderizar el contenido de esta secci√≥n
                        const customSectionId = topic.replace('custom-', '');
                        const customSection = sectionManager.customSections.find(s => s.id === customSectionId);
                        if (customSection) {
                            sectionManager.renderCustomSection(customSection);
                        }
                        
                    } else {
                        // --- L√ìGICA PARA SECCIONES NORMALES ---
                        currentContainer = DOM.zoomContainers[topic];
                        currentContainer.classList.add('active');
                        
                        // Poner en modo Zoom por defecto
                        state.isTraditionalScroll = false;
                        DOM.zoomScrollBtn.disabled = false;
                        DOM.zoomScrollBtn.classList.add('active');
                        DOM.traditionalScrollBtn.classList.remove('active');
                        currentContainer.classList.remove('traditional-scroll');
                        // Asegurarse de limpiar el contenedor din√°mico por si acaso
                        DOM.zoomContainers.dynamic.innerHTML = '';
                    }
                    
                    utils.resetGlowEffects();
                    
                    setTimeout(() => {
                        if (currentContainer.classList.contains('active')) {
                            // Aplicar estilos de UI guardados
                            customization.applyBackgroundAndContainerStyles();
                            customization.applyTextColors();
                        }
                    }, 100);
                    
                    setTimeout(() => {
                        // Iniciar animaci√≥n (no har√° nada en modo tradicional, lo cual es correcto)
                        animation.initializeZoom(topic);
                    }, 300);
                });
            },
            
            setupScrollModeButtons() {
                DOM.zoomScrollBtn.addEventListener('click', () => {
                    // No hacer nada si ya est√° activo o deshabilitado
                    if (!state.isTraditionalScroll || DOM.zoomScrollBtn.disabled) return;
                    
                    state.isTraditionalScroll = false;
                    DOM.zoomScrollBtn.classList.add('active');
                    DOM.traditionalScrollBtn.classList.remove('active');
                    
                    utils.resetGlowEffects();
                    
                    const container = DOM.zoomContainers[state.currentTopic];
                    container.classList.remove('traditional-scroll');
                    
                    // Si pasamos de una secci√≥n custom a zoom, el contenedor din√°mico no tiene contenido animable,
                    // por lo que debemos cambiar al contenedor est√°tico para que la animaci√≥n funcione.
                    // PERO, como el bot√≥n de zoom est√° deshabilitado para custom, esta l√≥gica solo aplica a temas predefinidos.
                    
                    setTimeout(() => {
                        customization.applyBackgroundAndContainerStyles();
                        customization.applyTextColors();
                    }, 100);
                    
                    animation.initializeZoom(state.currentTopic);
                });
                
                DOM.traditionalScrollBtn.addEventListener('click', () => {
                    if (state.isTraditionalScroll) return;
                    
                    state.isTraditionalScroll = true;
                    DOM.traditionalScrollBtn.classList.add('active');
                    DOM.zoomScrollBtn.classList.remove('active');
                    
                    if (state.currentZoomTimeline) {
                        state.currentZoomTimeline.kill();
                        ScrollTrigger.getAll().forEach(trigger => trigger.kill());
                    }
                    
                    utils.resetGlowEffects();
                    
                    let container;
                    if (state.currentTopic && state.currentTopic.startsWith('custom-')) {
                        container = DOM.zoomContainers.dynamic;
                        // Forzar re-renderizado en modo tradicional para secciones custom
                        const customSectionId = state.currentTopic.replace('custom-', '');
                        const customSection = sectionManager.customSections.find(s => s.id === customSectionId);
                        if (customSection) {
                            sectionManager.renderCustomSection(customSection);
                        }
                    } else {
                        container = DOM.zoomContainers[state.currentTopic];
                    }
                    
                    container.classList.add('traditional-scroll');
                    
                    setTimeout(() => {
                        customization.applyBackgroundAndContainerStyles();
                        customization.applyTextColors();
                    }, 100);
                });
            },
            
            setupBackToMenu() {
                DOM.backToMenuBtn.addEventListener('click', () => {
                    if (state.currentZoomTimeline) {
                        state.currentZoomTimeline.kill();
                        ScrollTrigger.getAll().forEach(trigger => trigger.kill());
                    }
                    
                    utils.resetGlowEffects();
                    
                    // Reset state
                    state.currentZoomTimeline = null;
                    state.currentImage = null;
                    state.currentTexts = [];
                    state.currentTopic = null;
                    state.isTraditionalScroll = false;
                    
                    DOM.zoomScrollBtn.classList.add('active');
                    DOM.traditionalScrollBtn.classList.remove('active');
                    DOM.zoomScrollBtn.disabled = false;
                    DOM.controls.style.display = 'none';
                    
                    Object.values(DOM.zoomContainers).forEach(container => {
                        container.classList.remove('active', 'traditional-scroll');
                    });
                    
                    // Limpiar contenido din√°mico
                    DOM.zoomContainers.dynamic.innerHTML = '';
                    
                    DOM.selectionContainer.classList.remove('selection-hidden');
                    
                    // Mostrar botones de importar/exportar cuando regresamos al men√∫ principal
                    document.querySelector('.import-export-controls').style.display = 'flex';
                    
                    setTimeout(() => {
                        utils.resetGlowEffects();
                        customization.applyBackgroundAndContainerStyles();
                        customization.applyTextColors();
                        customization.updateButtonStyles();
                    }, 100);
                });
            },
            
            setupResizeHandler() {
                window.addEventListener('resize', () => {
                    if (!state.isTraditionalScroll) {
                        ScrollTrigger.refresh();
                    }
                });
            }
        };
        
        // ========================================
        // INICIALIZACI√ìN
        // ========================================
        
        document.addEventListener('DOMContentLoaded', () => {
            // Registrar plugin de GSAP
            gsap.registerPlugin(ScrollTrigger);
            
            mainApp.initialize();
        });
    </script>
</body>
</html>